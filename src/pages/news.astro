---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const newsItems = await getCollection('news');
const sortedNews = newsItems.sort((a, b) =>
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<BaseLayout title="News" description="Stay up to date with MMTUK news, events, and announcements. Read about upcoming talks, new research publications, and community developments." currentPage="news">
<header class="section_header54 text-color-white">
        <div class="padding-global">
          <div class="container-large">
            <div class="padding-section-large">
              <div class="header54_component">
                <div class="max-width-large">
                  <div class="margin-bottom margin-small">
                    <h1 class="heading-style-h1">MMTUK News</h1>
                  </div>
                  <p class="text-size-medium-2">Insights and developments from our economic research team exploring modern monetary theory and policy innovations.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="header54_background-image-wrapper">
          <div class="image-overlay-layer"></div><img sizes="(max-width: 2400px) 100vw, 2400px" srcset="/images/jonathan-farber-KVlcVi-Ulgo-unsplash-p-500.avif 500w, images/jonathan-farber-KVlcVi-Ulgo-unsplash-p-800.avif 800w, images/jonathan-farber-KVlcVi-Ulgo-unsplash-p-1080.avif 1080w, images/newsroom.avif 2400w" alt="" src="/images/newsroom.avif" loading="eager" class="header54_background-image">
        </div>
      </header>

      <section class="section_blog1">
        <div class="padding-global">
          <div class="container-large">
            <div class="padding-section-large">
              <div class="blog1_component">
                <div class="w-layout-grid blog1_list">
                  {sortedNews.map((item) => (
                    <a href={`/news/${item.data.slug}`} class="blog1_item w-inline-block">
                      <div class="blog1_image-wrapper">
                        <img
                          src={item.data.thumbnail || '/images/placeholder-image.svg'}
                          loading="lazy"
                          alt={item.data.title}
                          class="blog1_image"
                        />
                      </div>
                      <div class="blog1_content">
                        <div class="blog1_content-top">
                          <div class="blog1_category-wrapper">
                            <div class="text-size-small text-weight-semibold text-color-primary">{item.data.category}</div>
                          </div>
                          <div class="margin-top margin-xsmall">
                            <h3 class="heading-style-h5">{item.data.title}</h3>
                          </div>
                          {item.data.summary && (
                          <div class="margin-top margin-xsmall">
                            <p class="text-size-regular">{item.data.summary.substring(0, 150)}...</p>
                          </div>
                          )}
                        </div>
                        <div class="blog1_content-bottom">
                          <div class="blog1_author-wrapper">
                            <div class="blog1_author-text">
                              <div class="text-size-small">{new Date(item.data.date).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' })}</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </a>
                  ))}
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
</BaseLayout>
